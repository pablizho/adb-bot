ADB Bot — установка и запуск (Windows)

ТРЕБОВАНИЯ
- Windows 10/11
- Python 3.11+ (рекомендую 3.11/3.12 с python.org; галочка “Add Python to PATH”)
- Android Platform Tools (adb) — либо в PATH, либо папка platform-tools рядом с проектом
- На телефоне: “Параметры для разработчиков” → “Отладка по USB”

ШАГИ ПО УСТАНОВКЕ
1) Установите Python (если ещё не установлен) с https://www.python.org/downloads/
   — во время установки включите “Add Python to PATH”.

2) Откройте командную строку в папке проекта (Shift+ПКМ → “Открыть окно команд…”).

3) Создайте виртуальное окружение:
   py -3 -m venv .venv

4) Активируйте его:
   .\.venv\Scripts\activate

5) Установите зависимости:
   pip install -r requirements.txt

6) Установите ADB (если его нет):
   - Скачайте “Android SDK Platform-Tools” (Google).
   - Распакуйте, добавьте путь к platform-tools в переменную PATH
     ИЛИ просто положите папку platform-tools рядом с проектом.
   - Проверка:
     adb version
     adb devices

7) (Только если при запуске появится ошибка “Can't find a usable init.tcl”)
   В этой сессии добавьте переменные для Tcl/Tk:
   set TCL_LIBRARY=%LocalAppData%\Programs\Python\Python313\tcl\tcl8.6
   set TK_LIBRARY=%LocalAppData%\Programs\Python\Python313\tcl\tk8.6
   Рекомендация: проще поставить Python 3.12 с python.org — проблема обычно исчезает.

ЗАПУСК GUI
1) Активируйте окружение (если ещё не активировано):
   .\.venv\Scripts\activate

2) Запустите GUI:
   python adb_bot_gui.py

3) В GUI выберите устройство (кнопка “Обновить список”), далее пользуйтесь кнопками:
   - “Записать сценарий…” — запись шагов в YAML
   - “Воспроизвести сценарий…” — проигрывание YAML
   - “Match-3” — калибровка сетки, один ход, автоплей

ПОДКЛЮЧЕНИЕ ПО WI-FI (опционально)
1) Подключите телефон по USB, включите отладку:
   adb devices
2) Переведите ADB в TCP/IP:
   adb tcpip 5555
3) Узнайте IP телефона и подключитесь:
   adb connect <IP-телефона>:5555
4) Отключите USB — устройство останется в списке “adb devices”.

ГОРЯЧИЕ КЛАВИШИ В ОКНЕ ЗАПИСИ
- ЛКМ клик              → записать TAP
- ЛКМ протяжка          → записать SWIPE
- Клавиши 1..9          → WAIT на N секунд
- i                     → выделить прямоугольник, сохранить шаблон и добавить WAIT_IMAGE
- m                     → один ход Match-3 (match3_once)
- a                     → автоплей N ходов (match3_auto)
- f                     → запустить фоновый автоплей
- g                     → остановить фоновый автоплей
- u                     → автоплей до появления/исчезновения картинки (match3_autoplay_until)
- c                     → отмена последнего шага
- s                     → сохранить сценарий и закрыть окно записи
- q                     → выйти без сохранения

ПАПКИ
- templates/  — сюда сохраняются шаблоны картинок для wait_image
- artifacts/  — сюда пишутся скриншоты и YAML с причиной при падении шага
(если папок нет — создадутся автоматически)

ЧАСТЫЕ ПРОБЛЕМЫ
- adb не найден → установите Platform Tools, добавьте в PATH или положите platform-tools рядом.
- Устройство не видно → поставьте драйверы (Google USB Driver / OEM), подтвердите ключ RSA на телефоне.
- Ошибка Tcl/Tk → см. шаг 7 или используйте Python 3.12 с python.org.
